# PICO4 Pro 微表情识别系统

这是一个基于PICO4 Pro面部追踪技术的微表情识别系统，能够实时识别用户的情绪并提供多种反馈机制。

## 系统组件

### 1. FTTest.cs
面部追踪的主控制脚本，负责：
- 初始化PICO面部追踪系统
- 获取面部blendshape数据
- 更新3D模型的表情

### 2. MicroExpressionRecognizer.cs
微表情识别核心组件，负责：
- 分析面部blendshape数据
- 识别8种基本情绪（中性、快乐、悲伤、愤怒、惊讶、恐惧、厌恶、困惑）
- 计算情绪置信度
- 平滑处理识别结果

### 3. EmotionFeedbackSystem.cs
情绪反馈系统，负责：
- 实时显示识别到的情绪
- 提供音频、视觉和触觉反馈
- 可自定义各种反馈类型

### 4. EmotionDataRecorder.cs
数据记录器，负责：
- 记录情绪和blendshape数据
- 导出为CSV格式
- 分析情绪数据

### 5. EmotionHistoryAnalyzer.cs
情绪历史分析器，负责：
- 分析情绪变化趋势
- 计算情绪稳定性和波动性
- 可视化情绪历史

## 使用方法

### 1. 基本设置

1. 将所有脚本添加到Unity项目中的同一个游戏对象上
2. 在Unity编辑器中设置各个组件的引用：
   - FTTest: 设置SkinnedMeshRenderer引用和UI元素
   - EmotionFeedbackSystem: 设置UI、图标、颜色和音频
   - EmotionHistoryAnalyzer: 设置可视化元素（可选）

3. 在Unity编辑器中确保PICO XR插件已正确配置

### 2. 运行系统

1. 在Unity编辑器中点击Play
2. 系统将自动初始化面部追踪
3. 将面部对准PICO4 Pro设备的摄像头
4. 系统将开始实时识别并显示情绪

### 3. 自定义设置

#### 调整识别参数
在MicroExpressionRecognizer组件中调整：
- **Confidence Threshold**: 识别置信度阈值（0.1-1.0）
- **Expression Hold Time**: 表情持续时间阈值（0.5-5.0秒）
- **Smoothing Frames**: 平滑处理的帧数（1-30）

#### 自定义反馈
在EmotionFeedbackSystem组件中：
- 添加不同情绪的图标、颜色和音频
- 启用/禁用不同类型的反馈
- 调整反馈冷却时间

#### 数据记录
在EmotionDataRecorder组件中：
- 设置记录间隔和文件名
- 选择记录情绪和/或blendshape数据
- 启用/禁用自动记录

## 应用场景

### 1. 心理健康监测
- 长期监测用户情绪状态
- 识别情绪波动模式
- 提供情绪健康建议

### 2. VR社交互动
- 在虚拟社交环境中反映用户真实情绪
- 增强VR社交的沉浸感和真实性
- 实现实时情绪驱动的虚拟表情

### 3. 培训与评估
- 销售培训：评估客户互动中的情绪反应
- 公共演讲：提供观众情绪反馈
- 面试训练：分析面试者的情绪状态

### 4. 游戏与娱乐
- 情绪驱动的游戏机制
- 根据玩家情绪调整游戏难度或内容
- 情绪化的角色互动

### 5. 市场研究
- 测试产品或广告的情绪反应
- 收集用户对设计的真实感受
- 分析用户体验的情绪曲线

## 技术细节

### 情绪识别算法
系统基于blendshape数据分析表情特征，使用权重映射方法：
- 每种情绪对应特定的面部特征组合
- 特征权重基于心理学研究设定
- 使用平滑处理减少误识别

### 数据格式
记录的数据包含：
- 时间戳
- 识别到的情绪类型
- 识别置信度
- 完整的blendshape数据（72个特征）

### 性能优化
- 可配置的平滑处理减少计算负载
- 可调整的记录间隔平衡数据精度和性能
- 事件驱动架构减少不必要的更新

## 故障排除

### 常见问题

1. **面部追踪不工作**
   - 检查PICO设备是否正确连接
   - 确认面部追踪权限已启用
   - 检查Unity中的PICO XR插件配置

2. **情绪识别不准确**
   - 调整置信度阈值
   - 增加平滑处理帧数
   - 确保面部光线充足

3. **UI元素不显示**
   - 检查Canvas设置
   - 确认UI引用已正确设置
   - 检查文本和图标资源

4. **数据记录失败**
   - 检查写入权限
   - 确认文件路径有效
   - 尝试使用绝对路径

## 未来扩展

1. **机器学习增强**
   - 集成深度学习模型提高识别精度
   - 个性化情绪模型训练
   - 自适应特征权重调整

2. **多模态融合**
   - 结合语音分析情绪
   - 融合生理信号（心率、皮电反应）
   - 综合行为模式分析

3. **云端分析**
   - 大规模情绪数据分析
   - 跨用户情绪模式比较
   - 远程情绪健康监测

## 许可证

本项目基于MIT许可证开源。

## 贡献

欢迎提交问题和改进建议！